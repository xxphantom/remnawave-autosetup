# Установщик Remnawave

## Описание

Этот скрипт предназначен для автоматической установки **Remnawave** - панели управления и ноды и **Steal oneself** - сайта-заглушки. Скрипт упрощает процесс развертывания, автоматизируя установку всех необходимых зависимостей, настройку Docker и создание конфигурационных файлов.

## Функциональность

Установщик предоставляет следующие возможности:
- Установка панели Remnawave с Caddy в качестве обратного прокси
- Установка ноды Remnawave
- Установка сайта-заглушки Steal oneself с Caddy
- Установка remnawave-json для работы с JSON-форматом подписок

## Системные требования

- ОС: Ubuntu (рекомендуется Ubuntu 22.04 или выше)
- Пользователь с правами root (sudo)

## Установка

Для запуска установщика выполните следующую команду в терминале:

```bash
bash <(curl -Ls https://raw.githubusercontent.com/xxphantom/remnawave-autosetup/refs/heads/dev/dist/install_remnawave.sh)
```

## Процесс установки

### Установка панели управления

1. После запуска скрипта выберите пункт **1) Установка панели Remnawave с Caddy**
2. Скрипт автоматически установит необходимые зависимости (Docker, Docker Compose и другие)
3. Вам потребуется ввести:
   - Токен Telegram бота
   - ID администратора Telegram
   - ID чата для уведомлений
   - Доменное имя для поддержки подписок
   - Доменное имя для веб-страницы подписок
   - Основной домен для панели управления
   - Домен для подписок
   - Имя пользователя и пароль SuperAdmin
4. Вам будет предложено установить remnawave-json:
   - При выборе "y" будет установлен remnawave-json из GitHub
   - Будут созданы директории для шаблонов и скачаны стандартные шаблоны
   - Вы сможете настроить параметры V2Ray Mux и текст объявления
   - Caddy будет настроен для работы с remnawave-json

### Настройка ноды

1. Выберите пункт **2) Установка ноды Remnawave**
2. Скрипт установит необходимые зависимости
3. Вам потребуется ввести:
   - Порт для подключения ноды
   - Сертификат сервера

### Настройка сайта-заглушки Steal oneself с Caddy

1. Выберите пункт **3) Настройка сайта-заглушки Steal oneself с Caddy**
2. Скрипт установит необходимые зависимости
3. Вам потребуется ввести:
   - Домен для сайта-заглушки (должен совпадать с XRAY конфигом - realitySettings.serverNames)
   - Порт для сайта-заглушки (должен совпадать с XRAY конфигом - realitySettings.dest)
4. Скрипт автоматически скачает необходимые файлы для веб-сайта и настроит Caddy
5. Данная заглушка будет доступна через Xray ноду и не будет доступна извне на своем порту (только локально)
6. Важно! Обязательно замените html статику на свою после установки

## Управление сервисами

После установки вы можете управлять сервисами с помощью команды `make` в соответствующих директориях:

**Директория панели**: `~/remnawave/panel`  
**Директория Caddy**: `~/remnawave/caddy`  
**Директория ноды**: `~/remnanode`  
**Директория сайта-заглушки**: `~/selfsteal`  
**Директория remnawave-json**: `~/remnawave/remnawave-json`

Доступные команды:
- `make start` - Запуск сервиса и просмотр логов
- `make stop` - Остановка сервиса
- `make restart` - Перезапуск сервиса
- `make logs` - Просмотр логов

## Доступ к панели управления

После успешной установки вы сможете получить доступ к панели управления по адресу:
```
https://ваш_домен_панели
```

Домен для подписок будет доступен по адресу:
```
https://ваш_домен_подписок
```

## Примечания

- Убедитесь, что у вас настроены DNS-записи для указанных доменов, направляющие на IP-адрес вашего сервера
- Рекомендуется использовать порт 443 для HTTPS-соединений
- Сохраните ваши учетные данные в безопасном месте

## Работа с remnawave-json

При установке remnawave-json создаются следующие шаблоны:
- Шаблон V2Ray: `~/remnawave/remnawave-json/templates/v2ray/default.json`
- Шаблон V2Ray Mux: `~/remnawave/remnawave-json/templates/mux/default.json`
- Шаблон страницы подписки: `~/remnawave/remnawave-json/templates/subscription/index.html`

Для изменения шаблонов:
1. Перейдите в директорию `~/remnawave/remnawave-json` и выполните: `make stop`
2. Измените нужные файлы шаблонов
3. Запустите сервисы снова: `make start`

При установке remnawave-json Caddy автоматически настраивается для работы с ним:
- Удаляется перезапись пути `/api/sub`
- Изменяется URL бэкенда подписок с 127.0.0.1:3000 на 127.0.0.1:4000 (или другой указанный порт)
- Caddy перезапускается для применения изменений
